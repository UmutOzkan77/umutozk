<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YBS DERS</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: dark;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, rgba(37, 99, 235, 0.18), rgba(15, 23, 42, 0.95) 45%), #0f172a;
      min-height: 100vh;
      color: #e2e8f0;
      display: flex;
      flex-direction: column;
    }

    main {
      flex: 1;
      width: min(1100px, 92vw);
      margin: 0 auto 4rem;
    }

    header {
      text-align: center;
      padding: 4.5rem 1rem 2rem;
    }

    .hero-eyebrow {
      letter-spacing: 0.45rem;
      text-transform: uppercase;
      font-size: 0.75rem;
      color: rgba(226, 232, 240, 0.6);
    }

    h1 {
      margin: 1.2rem 0;
      font-size: clamp(2.4rem, 5vw, 3.8rem);
      font-weight: 900;
      letter-spacing: -0.03em;
      background: linear-gradient(120deg, #38bdf8, #a855f7, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .hero-paragraph {
      margin: 0 auto;
      max-width: 640px;
      font-size: clamp(1rem, 2vw, 1.1rem);
      line-height: 1.6;
      color: rgba(226, 232, 240, 0.78);
    }

    .lessons-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 1.5rem;
      padding-bottom: 3rem;
    }

    .lesson-card {
      background: rgba(15, 23, 42, 0.75);
      border: 1px solid rgba(148, 163, 184, 0.25);
      border-radius: 1.35rem;
      padding: 1.65rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      backdrop-filter: blur(18px);
      box-shadow: 0 28px 60px rgba(15, 23, 42, 0.45);
      transition: transform 0.3s ease, border 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .lesson-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(140deg, rgba(99, 102, 241, 0.18), rgba(236, 72, 153, 0.12));
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .lesson-card:hover {
      transform: translateY(-6px);
      border-color: rgba(94, 234, 212, 0.45);
      box-shadow: 0 32px 72px rgba(15, 23, 42, 0.55);
    }

    .lesson-card:hover::after {
      opacity: 1;
    }

    .lesson-week {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.18);
      border: 1px solid rgba(56, 189, 248, 0.35);
      font-weight: 700;
      font-size: 0.78rem;
      letter-spacing: 0.02em;
      width: fit-content;
    }

    .lesson-title {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    .lesson-description {
      margin: 0;
      color: rgba(226, 232, 240, 0.75);
      font-size: 0.96rem;
      line-height: 1.55;
    }

    .materials-count {
      font-size: 0.8rem;
      font-weight: 600;
      color: rgba(148, 163, 184, 0.85);
      background: rgba(148, 163, 184, 0.18);
      border-radius: 999px;
      padding: 0.35rem 0.8rem;
      width: fit-content;
    }

    .materials-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 0.65rem;
    }

    .materials-item {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      font-size: 0.92rem;
      color: rgba(226, 232, 240, 0.85);
    }

    .materials-item a {
      color: inherit;
      text-decoration: none;
      border-bottom: 1px dashed rgba(94, 234, 212, 0.55);
      transition: color 0.2s ease;
    }

    .materials-item a:hover {
      color: #5eead4;
    }

    .card-actions {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-top: auto;
    }

    .card-button {
      border: none;
      border-radius: 999px;
      padding: 0.6rem 1.3rem;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .card-button.primary {
      background: linear-gradient(135deg, #6366f1, #a855f7);
      color: #edf2ff;
      box-shadow: 0 18px 42px rgba(99, 102, 241, 0.45);
    }

    .card-button.secondary {
      background: rgba(148, 163, 184, 0.22);
      color: rgba(226, 232, 240, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
    }

    .card-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 48px rgba(15, 23, 42, 0.55);
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      color: rgba(148, 163, 184, 0.6);
      font-size: 0.85rem;
    }

    @media (max-width: 640px) {
      header {
        padding: 3rem 1.2rem 1.5rem;
      }

      .lessons-grid {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      }
    }
  </style>
</head>
<body>
  <main>
    <header>
      <div class="hero-eyebrow">Y√∂netim Bili≈üim Sistemleri</div>
      <h1>YBS Ders Merkezi</h1>
      <p class="hero-paragraph">
        Haftalƒ±k ders sunumlarƒ± ve destek materyallerine tek ekrandan ula≈üƒ±n. Her hafta burasƒ± g√ºncellenecek. Fikir ve √∂neriler i√ßin mehmetumut2005@gmail.com
      </p>
    </header>

    <section class="lessons-grid" id="lessons-grid">
      <!-- cards -->
    </section>
  </main>

  <footer>
    YBS1103 ¬∑ Y√∂netim Bili≈üim Sistemlerine Giri≈ü &mdash; Umut √ñzkan
  </footer>

  <script src="lessons-data.js"></script>
  <script src="resource-viewer.js"></script>
  <script>
    (function () {
      const grid = document.getElementById("lessons-grid");

      const MATERIAL_ICONS = {
        pdf: "üìÑ",
        video: "üé¨",
        image: "üñºÔ∏è",
        audio: "üéß",
        slides: "üóÇÔ∏è",
        html: "üí°",
        link: "üîó",
        default: "üìÅ"
      };

      function normalisePath(value) {
        if (!value || /^https?:/i.test(value)) {
          return value;
        }
        return value.split("/").map((segment) => encodeURIComponent(segment)).join("/");
      }

      async function loadLessons() {
        try {
          const response = await fetch("lessons.index.json", { cache: "no-store" });
          if (response.ok) {
            const payload = await response.json();
            if (payload && Array.isArray(payload.lessons)) {
              return payload.lessons;
            }
          }
        } catch (error) {
          console.warn("lessons.index.json okunamadƒ±, lessons-data.js kullanƒ±lacak:", error);
        }
        return Array.isArray(window.LESSON_DIRECTORY) ? window.LESSON_DIRECTORY : [];
      }

      function resolveWeek(lesson, index) {
        const candidate = Number.parseInt(lesson.week ?? lesson.number ?? index + 1, 10);
        return Number.isNaN(candidate) ? index + 1 : candidate;
      }

      function resolveResources(lesson) {
        if (Array.isArray(lesson.resources)) {
          return lesson.resources;
        }
        if (Array.isArray(lesson.materials)) {
          return lesson.materials;
        }
        return [];
      }

      function openResource(resource) {
        const url = normalisePath(resource.path || resource.url);
        if (!url) {
          return;
        }
        if (resource.external) {
          window.open(url, "_blank", "noopener");
          return;
        }
        if (window.ResourceViewer) {
          window.ResourceViewer.open({
            url,
            label: resource.title || resource.label || resource.filename || "Materyal",
            type: resource.type || "default",
            downloadUrl: url,
            external: Boolean(resource.external)
          });
        } else {
          window.open(url, "_blank", "noopener");
        }
      }

      function handleResourceClick(event, resource) {
        event.preventDefault();
        openResource(resource);
      }

      function createMaterialsList(lesson, resources) {
        if (!resources.length) {
          return null;
        }
        const list = document.createElement("ul");
        list.className = "materials-list";
        resources.forEach((resource) => {
          const item = document.createElement("li");
          item.className = "materials-item";
          const icon = document.createElement("span");
          const typeKey = resource.type && MATERIAL_ICONS[resource.type] ? resource.type : "default";
          icon.textContent = MATERIAL_ICONS[typeKey];

          const link = document.createElement("a");
          link.href = normalisePath(resource.path || resource.url);
          link.textContent = resource.title || resource.label || resource.filename || "Materyal";
          link.target = resource.external ? "_blank" : "_self";
          link.rel = resource.external ? "noopener" : "";
          link.addEventListener("click", (event) => handleResourceClick(event, resource));

          item.appendChild(icon);
          item.appendChild(link);
          list.appendChild(item);
        });
        return list;
      }

      function renderLessons(lessons) {
        grid.innerHTML = "";
        if (!lessons.length) {
          const empty = document.createElement("div");
          empty.className = "lesson-card";
          empty.innerHTML = "<p>Hen√ºz ders eklenmedi. Yeni bir ders klas√∂r√º olu≈üturduƒüunuzda liste otomatik g√ºncellenecek.</p>";
          grid.appendChild(empty);
          return;
        }

        lessons
          .slice()
          .sort((a, b) => resolveWeek(a, 0) - resolveWeek(b, 0))
          .forEach((lesson, index) => {
            const weekNumber = resolveWeek(lesson, index);
            const resources = resolveResources(lesson);
            const card = document.createElement("article");
            card.className = "lesson-card";

            const weekBadge = document.createElement("span");
            weekBadge.className = "lesson-week";
            weekBadge.textContent = `${weekNumber.toString().padStart(2, "0")}`;
            card.appendChild(weekBadge);

            const title = document.createElement("h2");
            title.className = "lesson-title";
            title.textContent = lesson.title || `Ders ${weekNumber}`;
            card.appendChild(title);

            if (lesson.description) {
              const description = document.createElement("p");
              description.className = "lesson-description";
              description.textContent = lesson.description;
              card.appendChild(description);
            }

            const materialsCount = document.createElement("span");
            materialsCount.className = "materials-count";
            materialsCount.textContent = `Materyal sayƒ±sƒ±: ${resources.length}`;
            card.appendChild(materialsCount);

            const list = createMaterialsList(lesson, resources);
            if (list) {
              card.appendChild(list);
            }

            const actions = document.createElement("div");
            actions.className = "card-actions";

            const lessonUrl = normalisePath(lesson.lessonPath || lesson.htmlFile || "");

            if (lessonUrl) {
              const openButton = document.createElement("a");
              openButton.className = "card-button primary";
              openButton.href = lessonUrl;
              openButton.textContent = "üìò Dersi A√ß";
              actions.appendChild(openButton);
            }

            if (resources.length) {
              const materialsButton = document.createElement("button");
              materialsButton.type = "button";
              materialsButton.className = "card-button secondary";
              materialsButton.textContent = "üìé Materyalleri G√∂r";
              materialsButton.addEventListener("click", () => openResource(resources[0]));
              actions.appendChild(materialsButton);
            }

            card.appendChild(actions);
            grid.appendChild(card);
          });
      }

      async function init() {
        const lessons = await loadLessons();
        renderLessons(lessons);
      }

      init();
    })();
  </script>
</body>
</html>
